{% extends '../main1.html' %}
{% load static %}
{% block content %}
<div class="container">
    <form class="form-horizontal" method="post">
        {% csrf_token %}
        <fieldset>
            <!-- Form Name -->
            <legend class="mt-3">PRODUCTS</legend>

            <!-- First row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label">Vendor Name</label>
                        {{ form.vendor_name }}
                        {% if form.vendor_name.errors %}
                        <ul class="errorlist">
                            {% for error in form.vendor_name.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}

                        <small>{{ form.vendor_name.help_text }}</small>
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_name">PRODUCT NAME</label>
                        <input id="product_name" name="product_name" placeholder="" class="form-control" required=""
                            type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Select Basic -->
                    <div class="form-group mt-4">
                        <label class="control-label" for="product_categorie">PRODUCT CATEGORY</label>
                        {{ form.Categories }}
                        {% if form.Categories.errors %}
                        <ul class="errorlist">
                            {% for error in form.categories.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Second row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">TOTAL QUANTITY</label>
                        {{ form.total_quantity }}
                        {% if form.total_quantity.errors %}
                        <ul class="errorlist">
                            {% for error in form.total_quantity.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">AVAILABLE QUANTITY</label>
                        {{ form.Availability }}
                        {% if form.Availability.errors %}
                        <ul class="errorlist">
                            {% for error in form.Availability.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">PRODUCT PRICE</label>
                        {{ form.price }}
                        {% if form.price.errors %}
                        <ul class="errorlist">
                            {% for error in form.price.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- third row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">DISCOUNT</label>
                        {{ form.Discount }}
                        {% if form.Discount.errors %}
                        <ul class="errorlist">
                            {% for error in form.Discount.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}

                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">TAX</label>
                        {{ form.tax }}
                        {% if form.tax.errors %}
                        <ul class="errorlist">
                            {% for error in form.tax.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">PACKING COST</label>
                        {{ form.packing_cost }}
                        {% if form.packing_cost.errors %}
                        <ul class="errorlist">
                            {% for error in form.packing_cost.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- fourth row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">MODEL NAME</label>
                        {{ form.model_name }}
                        {% if form.model_name.errors %}
                        <ul class="errorlist">
                            {% for error in form.model_name.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">SLUG</label>
                        {{ form.slug }}
                        {% if form.slug.errors %}
                        <ul class="errorlist">
                            {% for error in form.slug.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                        <small id="slug-name-feedback" class="text-danger"></small>
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">TAG</label>
                        {{ form.Tags }}
                        {% if form.Tags.errors %}
                        <ul class="errorlist">
                            {% for error in form.Tags.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- fifth row -->
            <div class="row mb-4">
                <div class="col-md-8">
                    <!-- Textarea -->
                    <div class="form-group">
                        <label class="control-label" for="product_description">PRODUCT INFORMATION</label>
                        {{ form.media.Product_Information }}
                        {% if form.Product_Information.errors %}
                        <ul class="errorlist">
                            {% for error in form.Product_Information.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- File Button -->
                    <div class="form-group mt-4">
                        <label class="control-label" for="filebutton">FEATURED IMAGES</label>
                        {{ form.featured_image }}
                        {% if form.featured_image.errors %}
                        <ul class="errorlist">
                            {% for error in form.featured_image.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- sixth row -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <!-- Textarea -->
                    <div class="form-group">
                        <label class="control-label" for="product_description">DISCRIPTION</label>
                        {{ form.Description }}
                        {% if form.Description.errors %}
                        <ul class="errorlist">
                            {% for error in form.Description.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
                <div class="col-md-6">
                    <!-- File Button -->
                    <div class="form-group mt-4">
                        <label class="control-label" for="filebutton">SECTION</label>
                        {{ form.section }}
                        {% if form.section.errors %}
                        <ul class="errorlist">
                            {% for error in form.section.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                        <!-- <input id="filebutton" name="filebutton" class="input-file" type="file" multiple> -->
                    </div>
                </div>
            </div>

            <!-- seven row -->
            <div class="row">
                <div class="col-md-12">
                    <!-- Button -->
                    <div class="form-group">
                        <button type="submit" id="singlebutton" name="singlebutton" class="btn btn-primary">Add
                            product</button>
                    </div>
                </div>
            </div>

        </fieldset>
    </form>
</div>
<script>
    function checkslugName() {
        const slugInput = document.getElementById('id_slug');
        const slugName = slugInput.value.trim();

        // Perform AJAX request
        fetch(`../check_slug/?slug=${slugName}`)
            .then(response => response.json())
            .then(data => {
                const feedbackElement = document.getElementById('slug-name-feedback');
                if (data.exists) {
                    feedbackElement.innerText = 'Slug name already exists.';
                    feedbackElement.classList.add('text-danger');
                } else {
                    feedbackElement.innerText = 'Checking to if any exist';
                    feedbackElement.classList.remove('text-danger');
                }
            })
            .catch(error => {
                console.error(error);
            });
    }

    // Attach event listener to trigger the function on input change
    const slugInput = document.getElementById('id_slug');
    slugNameInput.addEventListener('input', checkslugName);

    $(".filter-checkbox").on('click', function () {
        var filter_object = {};
        console.log("checkbox clicked")
        $(".filter-checkbox").each(function (index, ele) {
            var filter_value = $(this).val();
            var filter_key = $(this).data('filter');
            console.log(filter_value);
            console.log(filter_key);
            filter_object[filter_key] = Array.from(document.querySelectorAll('input[data-filter=' + filter_key + ']:checked')).map(function (el) {
                return el.value;
            });
        });
        $.ajax({
            url: "{% url 'filter-data' %}",
            data: filter_object,
            dataType: 'json',
            success: function (res) {
                $("#filteredProducts").html(res.data);
                console.log("successfully executed")
            },
        });
    });
</script>

{% endblock %}