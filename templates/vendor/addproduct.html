{% extends '../main1.html' %}
{% load static %}
{% block content %}
<div class="container">
    <form class="form-horizontal">
        <fieldset>

            <!-- Form Name -->
            <legend class="mt-3">PRODUCTS</legend>

            <!-- First row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label">Vendor Name</label>
                        {{ form.vendor_name }}
                        {% if form.vendor_name.errors %}
                        <ul class="errorlist">
                            {% for error in form.vendor_name.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                        <small id="vendor-name-feedback" class="text-danger"></small>
                        <!-- <small>{{ form.vendor_name.help_text }}</small> -->
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_name">PRODUCT NAME</label>
                        <input id="product_name" name="product_name" placeholder="" class="form-control" required=""
                            type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Select Basic -->
                    <div class="form-group mt-4">
                        <label class="control-label" for="product_categorie">PRODUCT CATEGORY</label>
                        {{ form.Categories }}
                        {% if form.Categories.errors %}
                        <ul class="errorlist">
                            {% for error in form.categories.errors %}
                            <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Second row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">TOTAL QUANTITY</label>
                        <input id="available_quantity" name="available_quantity" placeholder="" class="form-control"
                            required="false" type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">AVAILABLE QUANTITY</label>
                        <input id="available_quantity" name="available_quantity" placeholder="" class="form-control"
                            required="" type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">PRODUCT PRICE</label>
                        <input id="product_price" name="product_price" placeholder="PRODUCT PRICE" class="form-control"
                            required="true" type="text">
                    </div>
                </div>
            </div>

            <!-- third row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">DISCOUNT</label>
                        <input id="product_price" name="product_price" placeholder="" class="form-control"
                            required="true" type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">TAX</label>
                        <input id="product_price" name="product_price" placeholder="" class="form-control"
                            required="true" type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">PACKING COST</label>
                        <input id="product_price" name="product_price" placeholder="" class="form-control"
                            required="true" type="text">
                    </div>
                </div>
            </div>

            <!-- fourth row -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">MODEL NAME</label>
                        <input id="available_quantity" name="available_quantity" placeholder="" class="form-control"
                            required="false" type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="available_quantity">SLUG</label>
                        <input id="available_quantity" name="slug" placeholder="" class="form-control" required=""
                            type="text">
                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Text input -->
                    <div class="form-group">
                        <label class="control-label" for="product_weight">TAG</label>
                        <input id="product_price" name="tag" placeholder="" class="form-control" required="true"
                            type="text">
                    </div>
                </div>
            </div>

            <!-- fifth row -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <!-- Textarea -->
                    <div class="form-group">
                        <label class="control-label" for="product_description">PRODUCT INFORMATION</label>
                        <textarea class="form-control" id="product_description" name="product_description"></textarea>
                    </div>
                </div>
                <div class="col-md-6">
                    <!-- File Button -->
                    <div class="form-group mt-4">
                        <label class="control-label" for="filebutton">FEATURED IMAGES</label>
                        <input id="filebutton" name="filebutton" class="input-file" type="file" multiple>
                    </div>
                </div>
            </div>

            <!-- sixth row -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <!-- Textarea -->
                    <div class="form-group">
                        <label class="control-label" for="product_description">ADDITIONAL INFORMATION</label>
                        <textarea class="form-control" id="product_description" name="product_description"></textarea>
                    </div>
                </div>
                <div class="col-md-6">
                    <!-- File Button -->
                    <div class="form-group mt-4">
                        <label class="control-label" for="filebutton">Additional IMAGES</label>
                        <input id="filebutton" name="filebutton" class="input-file" type="file" multiple>
                    </div>
                </div>
            </div>

            <!-- seven row -->
            <div class="row">
                <div class="col-md-12">
                    <!-- Button -->
                    <div class="form-group">
                        <button id="singlebutton" name="singlebutton" class="btn btn-primary">Button</button>
                    </div>
                </div>
            </div>

        </fieldset>
    </form>
</div>
<script>
    function checkVendorName() {
        const vendorNameInput = document.getElementById('id_vendor');
        const vendorName = vendorNameInput.value.trim();

        // Perform AJAX request
        fetch(`../check-vendor-name/?vendor_name=${vendorName}`)
            .then(response => response.json())
            .then(data => {
                const feedbackElement = document.getElementById('vendor-name-feedback');
                if (data.exists) {
                    feedbackElement.innerText = 'Vendor name already exists.';
                    feedbackElement.classList.add('text-danger');
                } else {
                    feedbackElement.innerText = '';
                    feedbackElement.classList.remove('text-danger');
                }
            })
            .catch(error => {
                console.error(error);
            });
    }

    // Attach event listener to trigger the function on input change
    const vendorNameInput = document.getElementById('id_vendor');
    vendorNameInput.addEventListener('input', checkVendorName);

    $(".filter-checkbox").on('click', function () {
        var filter_object = {};
        console.log("checkbox clicked")
        $(".filter-checkbox").each(function (index, ele) {
            var filter_value = $(this).val();
            var filter_key = $(this).data('filter');
            console.log(filter_value);
            console.log(filter_key);
            filter_object[filter_key] = Array.from(document.querySelectorAll('input[data-filter=' + filter_key + ']:checked')).map(function (el) {
                return el.value;
            });
        });
        $.ajax({
            url: "{% url 'filter-data' %}",
            data: filter_object,
            dataType: 'json',
            success: function (res) {
                $("#filteredProducts").html(res.data);
                console.log("successfully executed")
            },
        });
    });
</script>

{% endblock %}